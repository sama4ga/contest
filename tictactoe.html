<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tic Tac Toe</title>
  <style>
    table{
      border-collapse: collapse;
      margin: 30px auto;
    }
    td{
      border: 1px solid rgba(0,0,0,0.5);
      width: 100px;
      height: 100px;
      cursor: pointer;
      text-align: center;
      font-size: 40px;
    }
    td:active{
      background-color: silver;
    }

    td.o-mark::before{
      content: "o";
      color: red;
    }

    td.x-mark::before{
      content: "x";
      color: blue;
    }

    .message{
      text-align: center;
      margin-top: 10px;
    }

    #reset{
      display: flex;
      justify-content: center;
    }

  </style>
</head>
<body>
  <div class="message"></div>
  <table>
    <tr>
      <td id="tile1"></td>
      <td id="tile2"></td>
      <td id="tile3"></td>
    </tr>
    <tr>
      <td id="tile4"></td>
      <td id="tile5"></td>
      <td id="tile6"></td>
    </tr>
    <tr>
      <td id="tile7"></td>
      <td id="tile8"></td>
      <td id="tile9"></td>
    </tr>
  </table>

  <button type="button" id="reset">Reset</button>

  <script src="../Bootstrap/bootstrap-4.6.0-dist/js/jquery-3.51.min.js"></script>
  <script>
    $(document).ready(function() {
      var message = $(".message");
      var player, mark, finished;
      $("td:even").css("background-color","rgb(66,195,228)")
      $("td:odd").css("background-color","rgb(161,250,17)")

      init();

      $("td").on("click",function() {
        if (!checkCellState(this)) {
          $(this).addClass(mark);           
          if (!checkWin() && !checkDraw()){
            switchPlayer();
            mark = getPlayerMark();            
          }else{
            endGame();
          }
        }
      });

      $("#reset").click(function() {
        $("td").each(function() {
          $(this).removeClass("o-mark x-mark");
        });
        init();
      });

      function init() {
        player = Math.ceil(Math.random()*2);
        message.text("Player " + player + " starts");
        mark = getPlayerMark();
        finished = false;
      }

      function switchPlayer() {
        if (player == 1) {
          player = 2;
          message.text("Player " + player + " turn");
          return;
        }
        player = 1;        
        message.text("Player " + player + " turn");
        return;
      }

      function getPlayerMark() {
        if (player == 1) {
          return "o-mark";
        }
        return "x-mark";
      }

      function checkCellState(cell) {
        if ($(cell).hasClass("o-mark") || $(cell).hasClass("x-mark")) {
          return true;
        }
        return false;
      }

      function checkWin() {
        if (($("#tile1").hasClass(mark) && $("#tile2").hasClass(mark) && $("#tile3").hasClass(mark)) ||
        ($("#tile1").hasClass(mark) && $("#tile4").hasClass(mark) && $("#tile7").hasClass(mark)) ||
        ($("#tile1").hasClass(mark) && $("#tile5").hasClass(mark) && $("#tile9").hasClass(mark)) ||
        ($("#tile2").hasClass(mark) && $("#tile5").hasClass(mark) && $("#tile8").hasClass(mark)) ||
        ($("#tile3").hasClass(mark) && $("#tile6").hasClass(mark) && $("#tile9").hasClass(mark)) ||
        ($("#tile3").hasClass(mark) && $("#tile5").hasClass(mark) && $("#tile7").hasClass(mark)) ||
        ($("#tile4").hasClass(mark) && $("#tile5").hasClass(mark) && $("#tile6").hasClass(mark)) ||
        ($("#tile7").hasClass(mark) && $("#tile8").hasClass(mark) && $("#tile9").hasClass(mark))) {
          message.text("Player " + player + " won");
          return true;
        }
        return false;
      }

      function checkDraw() {
        let count = 0;
        $("td").each(function() {
          if ($(this).hasClass("o-mark") || $(this).hasClass("x-mark")) {
            count++;
          }
        });
        if (count == 9){
          message.text("Draw");
          return true;
        } 
        return false;
      }

      function endGame() {
        finished = true;
        $("td").off("click");
      }
    });
  </script>
</body>
</html>